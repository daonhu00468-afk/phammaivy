<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qu·∫£n L√Ω C√¢y Vi·∫øt</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#e5e5e5;
  display:flex;
  justify-content:center;
  padding:30px 0;
}

.phone{
  width:390px;
  background:white;
  border-radius:30px;
  overflow:hidden;
  box-shadow:0 20px 40px rgba(0,0,0,0.2);
}

.header{
  background:#4CAF50;
  color:white;
  padding:15px;
  text-align:center;
  font-weight:bold;
  position:relative;
}

.total{
  position:absolute;
  right:15px;
  top:15px;
  font-size:13px;
}

.content{
  padding:15px;
}

input{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:12px;
  border:1px solid #ccc;
}

button{
  width:100%;
  padding:10px;
  border:none;
  border-radius:12px;
  background:#4CAF50;
  color:white;
  margin-bottom:10px;
  cursor:pointer;
}

button:hover{
  background:#45a049;
}

.small-btn{
  font-size:11px;
  padding:4px 8px;
  width:auto;
  margin-left:5px;
}

.delete-btn{
  background:red;
}

.pen-item{
  background:#f5f5f5;
  padding:10px;
  border-radius:15px;
  margin-bottom:8px;
}

/* SEARCH N·ªîI B·∫¨T */
.search-box{
  position:relative;
  margin-top:10px;
}

.search-box input{
  padding-left:35px;
  background:#f0f7f2;
  border:2px solid transparent;
  transition:0.3s;
}

.search-box input:focus{
  border:2px solid #4CAF50;
  background:white;
  outline:none;
  box-shadow:0 0 8px rgba(76,175,80,0.3);
}

.search-icon{
  position:absolute;
  left:12px;
  top:11px;
  font-size:14px;
  color:#4CAF50;
}

.search-count{
  position:absolute;
  right:12px;
  top:11px;
  font-size:12px;
  color:#4CAF50;
  font-weight:bold;
}

.suggestions{
  background:white;
  border-radius:15px;
  box-shadow:0 8px 20px rgba(0,0,0,0.1);
  max-height:160px;
  overflow-y:auto;
  margin-top:5px;
  border:1px solid #e0e0e0;
}

.suggestion-item{
  padding:10px;
  font-size:14px;
  transition:0.2s;
  cursor:pointer;
}

.suggestion-item:hover{
  background:#e8f5e9;
}

.hidden{
  display:none;
}
</style>
</head>

<body>

<div class="phone">

<div id="loginBox" class="content">
  <h2 style="text-align:center;">ƒêƒÉng nh·∫≠p</h2>
  <input type="text" id="username" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n">
  <button onclick="login()">V√†o</button>
</div>

<div id="appBox" class="hidden">

  <div class="header">
    üìí Qu·∫£n L√Ω C√¢y Vi·∫øt
    <div class="total" id="total">T·ªïng: 0</div>
  </div>

  <div class="content">
    <div id="welcome" style="margin-bottom:10px;"></div>

    <input type="text" id="penName" placeholder="T√™n c√¢y vi·∫øt...">
    <input type="text" id="penNote" placeholder="Ch√∫ th√≠ch...">
    <button onclick="addPen()">Th√™m c√¢y vi·∫øt</button>

    <!-- SEARCH -->
    <div class="search-box">
      <span class="search-icon">üîé</span>
      <input type="text" id="searchInput" placeholder="T√¨m c√¢y vi·∫øt..." onkeyup="searchPens()">
      <div class="search-count" id="searchCount"></div>
    </div>
    <div id="suggestions" class="suggestions hidden"></div>

    <div id="penList"></div>

    <button onclick="logout()" style="background:#555;">ƒêƒÉng xu·∫•t</button>
  </div>

</div>

</div>

<script>
let currentUser = localStorage.getItem("currentUser");
let pens = [];
let editIndex = -1;

if(currentUser){
  startApp();
}

function login(){
  const user=document.getElementById("username").value.trim();
  if(user==="") return alert("Nh·∫≠p t√™n t√†i kho·∫£n!");
  localStorage.setItem("currentUser",user);
  startApp();
}

function startApp(){
  currentUser=localStorage.getItem("currentUser");
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("appBox").classList.remove("hidden");
  document.getElementById("welcome").innerText="Xin ch√†o: "+currentUser;
  pens=JSON.parse(localStorage.getItem("pens_"+currentUser))||[];
  renderPens();
}

function saveData(){
  localStorage.setItem("pens_"+currentUser,JSON.stringify(pens));
}

function updateTotal(){
  document.getElementById("total").innerText="T·ªïng: "+pens.length;
}

function addPen(){
  const name=document.getElementById("penName").value.trim();
  const note=document.getElementById("penNote").value.trim();
  if(name==="") return;

  if(editIndex===-1){
    pens.push({name,note});
  }else{
    pens[editIndex]={name,note};
    editIndex=-1;
  }

  saveData();
  renderPens();
  document.getElementById("penName").value="";
  document.getElementById("penNote").value="";
}

function editPen(index){
  document.getElementById("penName").value=pens[index].name;
  document.getElementById("penNote").value=pens[index].note;
  editIndex=index;
}

function deletePen(index){
  if(confirm("Xo√° c√¢y vi·∫øt n√†y?")){
    pens.splice(index,1);
    saveData();
    renderPens();
  }
}

function renderPens(){
  const list=document.getElementById("penList");
  list.innerHTML="";
  pens.forEach((pen,index)=>{
    list.innerHTML+=`
      <div class="pen-item">
        <b>${pen.name}</b><br>
        <small>${pen.note}</small><br><br>
        <button class="small-btn" onclick="editPen(${index})">S·ª≠a</button>
        <button class="small-btn delete-btn" onclick="deletePen(${index})">Xo√°</button>
      </div>
    `;
  });
  updateTotal();
}

function searchPens(){
  const keyword=document.getElementById("searchInput").value.toLowerCase();
  const suggestions=document.getElementById("suggestions");
  const countBox=document.getElementById("searchCount");

  if(keyword===""){
    suggestions.classList.add("hidden");
    countBox.innerText="";
    return;
  }

  const results=pens.filter(pen =>
    pen.name.toLowerCase().includes(keyword) ||
    pen.note.toLowerCase().includes(keyword)
  );

  countBox.innerText=results.length+" k·∫øt qu·∫£";

  suggestions.innerHTML="";
  results.forEach(pen=>{
    suggestions.innerHTML+=`
      <div class="suggestion-item">
        <b>${pen.name}</b> - ${pen.note}
      </div>
    `;
  });

  suggestions.classList.remove("hidden");
}

function logout(){
  localStorage.removeItem("currentUser");
  location.reload();
}
</script>

</body>
</html>
